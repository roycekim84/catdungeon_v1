# Agent Guide (Codex CLI 전용 작업 규칙)

이 문서는 이 저장소에서 **Codex CLI(에이전트)** 가 작업할 때 지켜야 할 규칙과 워크플로우를 정의한다.  
목표는 **Godot(GDScript)로 모바일(안드로이드) 출시 v1.0**까지, **v0.1부터 단계적으로 안정적으로** 진행하는 것이다.

---

## 0) 프로젝트 목표 / 원칙

### 목표
- Godot로 만든 모바일 아이들(Idle) 클리커 게임
- 최종 목표: **Android 출시(v1.0)**  
  - 최소: APK로 설치 테스트 가능
  - 가능하면: AAB(Play 배포 형태)까지도 준비

### 작업 원칙
- **작게, 자주, 안전하게**
  - 한 번에 큰 리팩터링 금지
  - 매 단계 실행 가능한 상태 유지
- **MVP 우선**
  - 예쁘게 만들기보다 “루프가 도는지”가 먼저
- **문서 기반 개발**
  - `docs/gdd.md`가 단일 진실 소스(SSOT)
  - 변경 사항은 문서에도 반영

---

## 1) Codex CLI 출력 규칙 (중요)

### “응답” 스타일
- 전체 코드를 통째로 붙여넣지 않는다.
- 대신 아래를 우선 제공한다:
  - 어떤 파일을 만들/수정했는지 목록
  - 중요한 코드 조각(핵심 함수/인터페이스)만 부분 발췌
  - 다음에 사용자가 실행할 명령/체크 방법
- 사용자가 “전체 코드 보여줘”라고 요구한 경우에만 전체를 출력한다.

### 변경 방식
- 가능한 한 **최소 변경(minimal diff)** 로 해결한다.
- 파일을 새로 만들 때는 아래 구조를 지킨다(3번 참고).
- 동일 기능이 여러 파일에 흩어지지 않게 한다(초기엔 단순하게).

### 실행/검증
- 변경 후에는 “플레이(실행)” 기준으로 오류가 없어야 한다.
- Godot 프로젝트는 최소 다음을 확인한다:
  - 에디터에서 Play 시 에러/경고 최소화
  - 메인 씬 로딩 정상
  - UI 클릭 이벤트 정상

---

## 2) 기술 스택 / 고정 전제

- Engine: **Godot 4.x (권장: 4.5.x stable)**
- Language: **GDScript**
- Target: Android (portrait)
- Dev env: macOS + VSCode (하지만 수정은 Codex CLI 중심)

---

## 3) 저장소 기본 구조(초기 권장)

- `scenes/` : 씬(.tscn)
- `scenes/ui/` : UI 씬
- `scripts/` : 스크립트
- `scripts/autoload/` : 싱글톤(게임 상태 등)
- `scripts/ui/` : UI 로직
- `assets/` : 이미지/사운드 등 리소스
- `docs/` : 문서 (GDD, 셋업, 릴리즈 체크리스트 등)

> 폴더가 없으면 생성하고, 새 파일은 목적에 맞는 폴더에 배치한다.

---

## 4) 네이밍 / 코드 컨벤션

### 파일/폴더
- 소문자 + 언더스코어: `game_state.gd`, `ui_root.tscn`
- 씬/노드 이름은 PascalCase 권장: `GameState`, `UIRoot`, `TopBar`

### 변수/함수
- snake_case: `gold_per_click`, `add_gold(amount)`

### 용어(중요)
- “GPS”는 위치(GPS)와 혼동되므로 문서/코드에서:
  - `gold_per_second` 또는 `GoldPerSecond (GPS)`로 명확히 표현한다.

---

## 5) 에셋 작업 규칙 (이미지/사운드)

- 에셋이 필요한 구간에서는 **먼저 “이미지 생성 프롬프트”** 를 작성한다.
- 그 다음, 아래 정보를 함께 제공한다:
  - 저장 폴더 경로
  - 파일명
  - 권장 해상도 / 포맷(PNG, 투명 배경 등)

예시:
- `assets/ui/icons/icon_gold.png`
- `512x512 PNG, transparent`

> 초기(v0.1~v0.2)는 “placeholder(임시)”도 허용한다.  
> 단, 파일 경로/이름은 나중에 바꾸기 어렵기 때문에 초기에 규칙을 지킨다.

---

## 6) 버전 진행 방식 (v0.1 → v1.0)

- v0.1: 프로젝트 뼈대 + Village 메인 + 탭으로 골드 증가 + UI 기본 골격
- v0.2: 업그레이드(10개 내외) + 비용 성장 + UI 팝업
- v0.3: 저장/로드 스키마 확정 + 자동 저장
- v0.4: 오프라인 수익 정산
- v0.5~: 고양이/배치/던전/맵/샵 탭 확장
- v1.0: Android export(APK/AAB), 설치 테스트, 릴리즈 체크리스트

각 버전 작업 시:
- `docs/gdd.md` 업데이트(필요한 경우)
- `docs/CHANGELOG.md` 또는 README에 버전 메모 반영(선택)

---

## 7) 작업 체크리스트(에이전트용)

작업 시작 전:
- [ ] 현재 버전 목표(v0.x) 확인
- [ ] 관련 문서(`docs/gdd.md`) 확인
- [ ] 변경 범위를 “작게” 쪼개기

작업 후:
- [ ] 프로젝트 실행 기준 오류 없음
- [ ] 새 파일/폴더 경로 규칙 준수
- [ ] 요약: 변경 파일 목록 + 사용자가 확인할 방법 제공
- [ ] 다음 단계 제안(단, 강요하지 않기)

---

## 8) 금지 사항

- 전체 코드 덤프(요청 없으면 금지)
- 대규모 리팩터링/폴더 이동(필요하면 단계로 쪼개기)
- 새 아키텍처 도입(초기엔 단순하게 유지)
- 빌드/플러그인/서드파티 의존성 남발

---

## 9) 문서 위치

- 게임 기획: `docs/gdd.md`
- 셋업 가이드(추가 예정): `docs/SETUP_GODOT.md`
- Android 릴리즈 체크리스트(추가 예정): `docs/RELEASE_ANDROID.md`
